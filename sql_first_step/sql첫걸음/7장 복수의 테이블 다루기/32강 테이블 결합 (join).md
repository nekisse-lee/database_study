## 테이블 결합 (join)

1.  곱집합과 교차집합
곱집합은 합집합이나 교집합처럼 집합의 연산 방법 중 하나다.

- 교차결합(cross join)
  - select 명령에서 from구에 테이블을 두 개 지정하면 이들은 곱집합으로 계산된다.
  
  ```
  - 교차결합
  select * from 테이블명1, 테이블명2
  ```
  
- ex) sample72_x와 sample72_y
  - select * from sample72_x;
    
    | x    |
    |------|
    | A    |
    | B    |
    | C    |
    
  - select * from sample72_y;
    
    | y    |
    |------|
    |    1 |
    |    2 |
    |    3 |
    
  - select * from sample72_x, sample72_y;
     - 같은 결과
     - select * from sample72_x cross join sample72_y;
      
    | x    | y    |
    |------|------|
    | A    |    1 |
    | B    |    1 |
    | C    |    1 |
    | A    |    2 |
    | B    |    2 |
    | C    |    2 |
    | A    |    3 |
    | B    |    3 |
    | C    |    3 |
    
    
### 2. 내부결합 

- 상품 테이블 작성
  ```sql
    create table 상품(
      상품코드 char(4) not null,
      상품명 varchar(30),
      메이커명 varchar(30),
      가격 integer,
      상품분류 varchar(30),
      primary key (상품코드)
  );
  ```
  
- 재고수 테이블 작성
  ```sql
  create table 재고수(
    상품코드 char(4),
    입고날짜 date,
    재고수 integer
    );
  ```
  
- ex) 상품 테이블과 재고수 테이블을 교차결합하기
  - select * from 상품, 재고수;
    
    | 상품코드     | 상품명    | 메이커명     | 가격   | 상품분류     | 상품코드     | 입고날짜     | 재고수    |
    |--------------|-----------|--------------|--------|--------------|--------------|--------------|-----------|
    | 0001         | 상품1     | 메이커1      |    100 | 식료품       | 0001         | 2014-01-03   |       200 |
    | 0002         | 상품2     | 메이커2      |    200 | 식료품       | 0001         | 2014-01-03   |       200 |
    | 0003         | 상품3     | 메이커3      |   1980 | 생활용품     | 0001         | 2014-01-03   |       200 |
    | 0001         | 상품1     | 메이커1      |    100 | 식료품       | 0002         | 2014-02-10   |       500 |
    | 0002         | 상품2     | 메이커2      |    200 | 식료품       | 0002         | 2014-02-10   |       500 |
    | 0003         | 상품3     | 메이커3      |   1980 | 생활용품     | 0002         | 2014-02-10   |       500 |
    | 0001         | 상품1     | 메이커1      |    100 | 식료품       | 0003         | 2014-02-14   |        10 |
    | 0002         | 상품2     | 메이커2      |    200 | 식료품       | 0003         | 2014-02-14   |        10 |
    | 0003         | 상품3     | 메이커3      |   1980 | 생활용품     | 0003         | 2014-02-14   |        10 |
    
  - 상품코드가 같은 행을 검색하기
    - select * from 상품, 재고수 where 상품.상품코드 = 재고수.상품코드;
      
      | 상품코드     | 상품명    | 메이커명     | 가격   | 상품분류     | 상품코드     | 입고날짜     | 재고수    |
      |--------------|-----------|--------------|--------|--------------|--------------|--------------|-----------|
      | 0001         | 상품1     | 메이커1      |    100 | 식료품       | 0001         | 2014-01-03   |       200 |
      | 0002         | 상품2     | 메이커2      |    200 | 식료품       | 0002         | 2014-02-10   |       500 |
      | 0003         | 상품3     | 메이커3      |   1980 | 생활용품     | 0003         | 2014-02-14   |        10 |
    
  - 상품코드가 같은 행을 검색 + 상품분류가 '식료품' 인 행과 열 의  상품명과, 재고수 출력
    ```sql
    select 상품.상품명, 재고수.재고수 
    from 상품, 재고수 
    where 상품.상품코드 = 재고수.상품코드 
    and 상품.상품분류 = '식료품';
    ```
    
    | 상품명    | 재고수    |
    |-----------|-----------|
    | 상품1     |       200 |
    | 상품2     |       500 |
    
    - where 구에는 `두 개의 조건식`이 지정되어 있다.  
    첫 번째 조건식은 교차결합으로 계산된 곱집합에서 원하는 `조합을 검색`하는 것  
    두 번째 조건식은 `결합 조건이 아닌 검색 조건`
    여기서 첫 번째 조건식의 조건은 `결합조건`
    
### 3. inner join으로 내부결합하기

- from 구에 테이블을 복수 지정해 가로 방향으로 테이블을 결합할 수 있다.
- 교차결합을 하면 곱집합으로 계산된다.
- where 조건을 지정해 곱집합에서 필요한 조합만 검색할 수 있다.

#### 위의 설명한 결합방법은 구식이다.
최근에는 inner join 키워드를 사용한 결합방법이 일반적으로 통용된다.  

 위의 2.  의 예제들을 inner join으로 변경
 ```sql 
-- 구식 결합
select 상품.상품명, 재고수.재고수 
from 상품, 재고수 
where 상품.상품코드 = 재고수.상품코드 
  and 상품.상품분류 = '식료품';
```

```sql 
-- inner join
select 상품.상품명, 재고수.재고수 
from 상품 
    inner join 재고수 
        on 상품.상품코드 = 재고수.상품코드 
where 상품.상품분류 = '식료품';
```

```sql
-- 내부결합 (inner join)
select * from 테이블명1 
    inner join 테이블명2 
        on 결합조건;
```

구식 방법에서는 쉼표(,)로 구분하여 테이블을 from 구에 지정.  
새로운 형식에서는 테이블과 테이블 사이에 'inner join' 이라는 키워드를 삽입.  

구식 방법에서는 `where 구에 결합조건`(where 상품.상품코드 = 재고수.상품코드)을 지정하였지만,  
inner join에서는 `on 을 사용하여 결합조건`(on 상품.상품코드 = 재고수.상품코드)을 지정
    